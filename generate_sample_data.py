#!/usr/bin/env python3
"""
Thailand Air Quality Data Generator
‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏•‡∏∞‡∏°‡∏•‡∏û‡∏¥‡∏©‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢
"""

import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import random
import os
import config

def generate_thailand_air_quality_data(num_days=30, interval_minutes=5):
    """
    ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
    
    Args:
        num_days: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        interval_minutes: ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏ô‡∏≤‡∏ó‡∏µ)
    
    Returns:
        pandas.DataFrame: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢
    """
    
    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô data points
    points_per_day = (24 * 60) // interval_minutes
    total_points = num_days * points_per_day
    
    print(f"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏ó‡∏¢ {total_points:,} ‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ({num_days} ‡∏ß‡∏±‡∏ô)")
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á timestamp
    start_time = datetime.now() - timedelta(days=num_days)
    timestamps = []
    current_time = start_time
    
    for i in range(total_points):
        timestamps.append(current_time.isoformat())
        current_time += timedelta(minutes=interval_minutes)
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö (pattern-based)
    data = []
    
    for i, timestamp in enumerate(timestamps):
        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏ß‡∏±‡∏ô (0-24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
        hour_of_day = (i * interval_minutes / 60) % 24
        day_of_week = (i // points_per_day) % 7
        
        # ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ (‡∏°‡∏•‡∏û‡∏¥‡∏©‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô - ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢)
        if 7 <= hour_of_day <= 9 or 17 <= hour_of_day <= 19:  # Rush hours (‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø)
            pm25_base = random.uniform(35, 65)  # ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° (‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏ó‡∏¢)
            pm10_base = random.uniform(45, 85)
        elif 22 <= hour_of_day or hour_of_day <= 6:  # Night time
            pm25_base = random.uniform(15, 35)  # ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏°‡∏µ‡∏°‡∏•‡∏û‡∏¥‡∏©‡∏ï‡∏Å‡∏Ñ‡πâ‡∏≤‡∏á
            pm10_base = random.uniform(25, 45)
        else:  # Normal hours
            pm25_base = random.uniform(25, 45)  # ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢
            pm10_base = random.uniform(35, 60)
        
        # ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô (‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏°‡∏•‡∏û‡∏¥‡∏©‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤)
        if day_of_week in [5, 6]:  # Weekend
            pm25_base *= 0.7
            pm10_base *= 0.7
        
        # ‡πÄ‡∏û‡∏¥‡πà‡∏° noise ‡πÅ‡∏•‡∏∞ seasonal variation
        seasonal_factor = 1 + 0.3 * np.sin(2 * np.pi * (i / total_points))
        noise_factor = random.uniform(0.8, 1.2)
        
        pm25 = max(0, pm25_base * seasonal_factor * noise_factor)
        pm10 = max(0, pm10_base * seasonal_factor * noise_factor)
        
        # ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢)
        temp_base = 28 + 6 * np.sin(2 * np.pi * hour_of_day / 24)  # 22-34¬∞C (‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô)
        temp_seasonal = 4 * np.sin(2 * np.pi * (i / total_points))  # ¬±4¬∞C (‡∏§‡∏î‡∏π‡∏£‡πâ‡∏≠‡∏ô-‡∏ù‡∏ô)
        temperature = temp_base + temp_seasonal + random.uniform(-2, 2)  # 20-38¬∞C
        
        # ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢ (‡∏™‡∏π‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ)
        humidity_base = 75 - (temperature - 28) * 1.5  # ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏π‡∏á
        humidity = max(50, min(95, humidity_base + random.uniform(-10, 10)))  # 50-95%
        
        # ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏Å‡πä‡∏™ (‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö PM)
        gas_level = int(200 + pm25 * 5 + random.uniform(-50, 50))
        gas_level = max(100, min(800, gas_level))
        
        data.append({
            'timestamp': timestamp,
            'pm25': round(pm25, 1),
            'pm10': round(pm10, 1),
            'temperature': round(temperature, 1),
            'humidity': round(humidity, 1),
            'gas_level': gas_level
        })
    
    df = pd.DataFrame(data)
    print(f"‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô: {len(df):,} records")
    
    return df

def add_thailand_weather_events(df):
    """
    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢
    - ‡∏ù‡∏ô‡∏°‡∏£‡∏™‡∏∏‡∏°, ‡∏´‡∏°‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏±‡∏ô, ‡πÄ‡∏ú‡∏≤‡πÉ‡∏™‡πà
    """
    print("üåßÔ∏è ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢...")
    
    # ‡∏ù‡∏ô‡∏°‡∏£‡∏™‡∏∏‡∏°‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢ (‡∏û.‡∏Ñ.-‡∏ï.‡∏Ñ.)
    rain_events = random.sample(range(len(df)), len(df) // 8)  # 12.5% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏§‡∏î‡∏π‡∏ù‡∏ô‡πÑ‡∏ó‡∏¢)
    
    for idx in rain_events:
        # ‡∏ù‡∏ô‡∏°‡∏£‡∏™‡∏∏‡∏°‡πÑ‡∏ó‡∏¢ - ‡∏ù‡∏ô‡πÅ‡∏£‡∏á ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏•‡∏û‡∏¥‡∏©‡πÑ‡∏î‡πâ‡∏î‡∏µ
        df.loc[idx, 'pm25'] *= 0.15  # ‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 15% (‡∏ù‡∏ô‡πÑ‡∏ó‡∏¢‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å)
        df.loc[idx, 'pm10'] *= 0.25  # ‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 25%
        df.loc[idx, 'humidity'] = min(98, df.loc[idx, 'humidity'] + 20)  # ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
        df.loc[idx, 'temperature'] -= 4  # ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏î‡∏•‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
        df.loc[idx, 'gas_level'] *= 0.7  # ‡πÅ‡∏Å‡πä‡∏™‡∏•‡∏î‡∏•‡∏á‡∏î‡πâ‡∏ß‡∏¢
    
    # ‡∏´‡∏°‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢ (‡∏ò.‡∏Ñ.-‡πÄ‡∏°.‡∏¢.)
    pollution_events = random.sample(range(len(df)), len(df) // 25)  # 4% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢)
    
    for idx in pollution_events:
        # ‡∏´‡∏°‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏±‡∏ô‡πÑ‡∏ó‡∏¢ - ‡πÄ‡∏ú‡∏≤‡πÉ‡∏™‡πà ‡∏ù‡∏∏‡πà‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏î‡∏ô
        df.loc[idx, 'pm25'] *= random.uniform(4, 8)  # PM2.5 ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å (200-400+ Œºg/m¬≥)
        df.loc[idx, 'pm10'] *= random.uniform(3, 5)  # PM10 ‡∏™‡∏π‡∏á‡∏ï‡∏≤‡∏°
        df.loc[idx, 'gas_level'] *= random.uniform(2.5, 4)  # ‡πÅ‡∏Å‡πä‡∏™‡∏û‡∏¥‡∏©‡∏™‡∏π‡∏á
        df.loc[idx, 'humidity'] *= 0.85  # ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏´‡πâ‡∏á‡∏Å‡∏ß‡πà‡∏≤
        df.loc[idx, 'temperature'] += random.uniform(1, 3)  # ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
    
    print("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏ó‡∏¢‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô")
    return df

def generate_thailand_training_data():
    """
    ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• AI ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
    """
    print("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• AI ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢...")
    print("=" * 50)
    
    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if os.path.exists(config.RAW_DATA_FILE):
        existing_df = pd.read_csv(config.RAW_DATA_FILE)
        if len(existing_df) > 1000:
            print(f"üìä ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏° {len(existing_df):,} records")
            choice = input("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà? (add/new/cancel): ").lower()
            
            if choice == 'cancel':
                print("‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")
                return
            elif choice == 'add':
                print("‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...")
                new_df = generate_realistic_air_quality_data(num_days=7)  # ‡πÄ‡∏û‡∏¥‡πà‡∏° 7 ‡∏ß‡∏±‡∏ô
                new_df = add_weather_events(new_df)
                
                # ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡∏°‡πà
                combined_df = pd.concat([existing_df, new_df], ignore_index=True)
                combined_df.to_csv(config.RAW_DATA_FILE, index=False)
                print(f"‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô: ‡∏£‡∏ß‡∏° {len(combined_df):,} records")
                return
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
    print("üÜï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...")
    
    # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô
    print("\n‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏ó‡∏¢:")
    print("1. ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å (7 ‡∏ß‡∏±‡∏ô) - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö")
    print("2. ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á (30 ‡∏ß‡∏±‡∏ô) - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏ó‡∏¢")
    print("3. ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (90 ‡∏ß‡∏±‡∏ô) - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏ó‡∏¢ (‡∏Ñ‡∏£‡∏ö 1 ‡∏§‡∏î‡∏π)")
    print("4. ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å (180 ‡∏ß‡∏±‡∏ô) - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏ó‡∏¢ (‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏§‡∏î‡∏π)")
    
    choice = input("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (1-4): ").strip()
    
    if choice == '1':
        num_days = 7
        print("üìÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢ 7 ‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2,000 records)")
    elif choice == '2':
        num_days = 30
        print("üìÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢ 30 ‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 8,600 records)")
    elif choice == '3':
        num_days = 90
        print("üìÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢ 90 ‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 25,900 records)")
    elif choice == '4':
        num_days = 180
        print("üìÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢ 180 ‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 51,800 records)")
    else:
        num_days = 30
        print("üìÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢ 30 ‡∏ß‡∏±‡∏ô")
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢
    df = generate_thailand_air_quality_data(num_days=num_days)
    df = add_thailand_weather_events(df)
    
    # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    df.to_csv(config.RAW_DATA_FILE, index=False)
    print(f"üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà: {config.RAW_DATA_FILE}")
    
    # ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
    print("\n‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:")
    print(f"   ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô records: {len(df):,}")
    print(f"   PM2.5 ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {df['pm25'].mean():.1f} Œºg/m¬≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢: <37.5)")
    print(f"   PM10 ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {df['pm10'].mean():.1f} Œºg/m¬≥ (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢: <50)")
    print(f"   ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {df['temperature'].mean():.1f} ¬∞C (‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢)")
    print(f"   ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {df['humidity'].mean():.1f} % (‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô‡∏ä‡∏∑‡πâ‡∏ô)")
    
    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if len(df) >= config.MIN_DATA_FOR_LSTM:
        print(f"‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LSTM model ({len(df):,} >= {config.MIN_DATA_FOR_LSTM:,})")
    elif len(df) >= 1000:
        print(f"‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Random Forest model ({len(df):,} >= 1,000)")
    else:
        print(f"‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1,000 records)")
    
    print("\nüéØ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß")

def create_sample_predictions():
    """
    ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
    """
    print("üîÆ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á...")
    
    # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ
    if not os.path.exists(config.RAW_DATA_FILE):
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô")
        return
    
    df = pd.read_csv(config.RAW_DATA_FILE)
    if len(df) < 100:
        print("‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå")
        return
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
    predictions = []
    
    # ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 20% ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå
    sample_size = min(200, len(df) // 5)
    sample_data = df.tail(sample_size)
    
    for _, row in sample_data.iterrows():
        for horizon in [1, 3, 6]:  # 1, 3, 6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
            # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ error ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
            error_factor = random.uniform(0.85, 1.15)
            
            pred_data = {
                'timestamp': row['timestamp'],
                'prediction_time': (pd.to_datetime(row['timestamp']) + 
                                  timedelta(hours=horizon)).isoformat(),
                'horizon_hours': horizon,
                'model_type': random.choice(['LSTM', 'RandomForest']),
                'predicted_pm25': round(row['pm25'] * error_factor, 1),
                'predicted_pm10': round(row['pm10'] * error_factor, 1),
                'predicted_temp': round(row['temperature'] * random.uniform(0.95, 1.05), 1),
                'predicted_humidity': round(row['humidity'] * random.uniform(0.9, 1.1), 1),
                'actual_pm25': row['pm25'],
                'actual_pm10': row['pm10'],
                'actual_temp': row['temperature'],
                'actual_humidity': row['humidity']
            }
            predictions.append(pred_data)
    
    pred_df = pd.DataFrame(predictions)
    pred_df.to_csv(config.PREDICTIONS_FILE, index=False)
    
    print(f"‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå: {len(pred_df):,} records")
    print(f"üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà: {config.PREDICTIONS_FILE}")

def main():
    """
    ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ó‡∏¢
    """
    print("Thailand Air Quality AI - Data Generator")
    print("=" * 50)
    print("‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢")
    print()
    
    while True:
        print("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:")
        print("1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏ó‡∏¢")
        print("2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á")
        print("3. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà")
        print("4. ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°")
        
        choice = input("\n‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (1-4): ").strip()
        
        if choice == '1':
            generate_thailand_training_data()
        elif choice == '2':
            create_sample_predictions()
        elif choice == '3':
            show_existing_data()
        elif choice == '4':
            print("üëã ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!")
            break
        else:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1-4")
        
        print("\n" + "=" * 50)

def show_existing_data():
    """
    ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
    """
    print("üìä ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà...")
    
    # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å
    if os.path.exists(config.RAW_DATA_FILE):
        df = pd.read_csv(config.RAW_DATA_FILE)
        print(f"‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®: {len(df):,} records")
        if len(df) > 0:
            print(f"   ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: {df['timestamp'].iloc[0]} ‡∏ñ‡∏∂‡∏á {df['timestamp'].iloc[-1]}")
            print(f"   PM2.5 ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {df['pm25'].mean():.1f} Œºg/m¬≥")
    else:
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®")
    
    # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå
    if os.path.exists(config.PREDICTIONS_FILE):
        pred_df = pd.read_csv(config.PREDICTIONS_FILE)
        print(f"‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå: {len(pred_df):,} records")
    else:
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå")
    
    # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
    if os.path.exists(config.ACCURACY_LOG_FILE):
        acc_df = pd.read_csv(config.ACCURACY_LOG_FILE)
        print(f"‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥: {len(acc_df):,} records")
    else:
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥")

if __name__ == "__main__":
    main()
